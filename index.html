<!DOCTYPE html>
<html>
  <head><title>vertical tab demo</title></head>
  <body>
    <p>Use alt-tab (windows) or option-tab (mac) to move down.</p>
    <p>Use shift-alt-tab or shift-option-tab to move up.</p>
    <p>Save this <a id="bookmarklet">bookmarklet</a> to have the same functionality on other pages.</p>
    <table>
      <tr>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
      </tr>
      <tr>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
      </tr>
      <tr>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
      </tr>
      <tr>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
        <td><input size="3"></td>
      </tr>
    </table>
    <script id="bookmarklet-src">
      // TODO: Factor this out as a bookmarklet.
      window.addEventListener('keydown', (e) => {
        if (e.altKey && e.keyCode == 9) {
          const moveUp = e.shiftKey;
          // TODO: Walk up the tree: There might be wrapping elements.
          // TODO: What about <tbody>?
          const td = document.activeElement.parentElement;
          const tr = td.parentElement;
          const table = tr.parentElement;
          console.log(`row ${tr.rowIndex}, col ${td.cellIndex}`);

          const targetRowIndex = tr.rowIndex + (moveUp ? -1 : 1);
          const targetCell = table.rows[targetRowIndex].cells[td.cellIndex];
          // TODO: Walk down the tree to find <input>.
          console.log(targetCell);
          targetCell.children[0].focus()
        }
      });
    </script>
    <script>
      const js = document.getElementById('bookmarklet-src').textContent;
      const minJs = js.replace(/\/\/.*/g, '').replace(/\s+/g, ' ');
      console.log(minJs);
      const url = 'javascript:' + encodeURIComponent(minJs)
      document.getElementById('bookmarklet').setAttribute('href', url);
    </script>
  </body>
</html>